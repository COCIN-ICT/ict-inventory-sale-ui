<div class="font-sans">
  <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="max-w-5xl mx-auto">
    <!-- Main Card Container - Reduced padding on tiny screens (p-6) for better edge-to-edge look -->
    <div class="bg-white shadow-2xl rounded-3xl p-6 sm:p-8 md:p-12 transition-all duration-300">

      <!-- Header -->
      <h2 class="text-2xl sm:text-3xl font-extrabold text-gray-900 mb-6 sm:mb-8 pb-3 border-b border-gray-100">
        Create New System User
      </h2>

      <!-- Form Fields Grid (1 column on mobile, 3 columns on medium screens and up) -->
      <div class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-x-6 gap-y-5">

          <!-- First Name -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1.5">First Name <span class="text-red-500">*</span></label>
            <input type="text" formControlName="firstName" placeholder="Enter first name"
              class="w-full px-4 py-2.5 text-sm border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200" />
            <div *ngIf="userForm.get('firstName')?.invalid && userForm.get('firstName')?.touched" class="text-red-500 text-xs mt-1">
              First name is required.
            </div>
          </div>

          <!-- Middle Name -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1.5">Middle Name</label>
            <input type="text" formControlName="middleName" placeholder="Enter middle name"
              class="w-full px-4 py-2.5 text-sm border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200" />
          </div>

          <!-- Last Name -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1.5">Last Name <span class="text-red-500">*</span></label>
            <input type="text" formControlName="lastName" placeholder="Enter last name"
              class="w-full px-4 py-2.5 text-sm border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200" />
            <div *ngIf="userForm.get('lastName')?.invalid && userForm.get('lastName')?.touched" class="text-red-500 text-xs mt-1">
              Last name is required.
            </div>
          </div>

          <!-- Username (Full width on mobile, 2 columns wide on medium screens) -->
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-1.5">Username <span class="text-red-500">*</span></label>
            <input type="text" formControlName="username" placeholder="Enter username"
              class="w-full px-4 py-2.5 text-sm border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200" />
            <div *ngIf="userForm.get('username')?.invalid && userForm.get('username')?.touched" class="text-red-500 text-xs mt-1">
              Username is required.
            </div>
          </div>

          <!-- Email -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1.5">Email <span class="text-red-500">*</span></label>
            <input type="email" formControlName="email" placeholder="Enter email"
              class="w-full px-4 py-2.5 text-sm border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200" />
            <div *ngIf="userForm.get('email')?.invalid && userForm.get('email')?.touched" class="text-red-500 text-xs mt-1">
              <span *ngIf="userForm.get('email')?.errors?.['required']">Email is required.</span>
              <span *ngIf="userForm.get('email')?.errors?.['email']">Please enter a valid email.</span>
            </div>
          </div>

          <!-- Password -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1.5">Password <span class="text-red-500">*</span></label>
            <input type="password" formControlName="password" placeholder="Enter password"
              class="w-full px-4 py-2.5 text-sm border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200" />
            <div *ngIf="userForm.get('password')?.invalid && userForm.get('password')?.touched" class="text-red-500 text-xs mt-1">
              <span *ngIf="userForm.get('password')?.errors?.['required']">Password is required.</span>
              <span *ngIf="userForm.get('password')?.errors?.['minlength']">Password must be at least 6 characters.</span>
            </div>
          </div>

          <!-- Phone Number -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1.5">Phone Number <span class="text-red-500">*</span></label>
            <input type="tel" formControlName="phone" placeholder="Enter phone number"
              class="w-full px-4 py-2.5 text-sm border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200" />
            <div *ngIf="userForm.get('phone')?.invalid && userForm.get('phone')?.touched" class="text-red-500 text-xs mt-1">
              Phone number is required.
            </div>
          </div>

          <!-- Address (Full width on mobile, 2 columns wide on medium screens) -->
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-1.5">Address <span class="text-red-500">*</span></label>
            <textarea formControlName="address" rows="2" placeholder="Enter address"
              class="w-full px-4 py-2.5 text-sm border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200"></textarea>
            <div *ngIf="userForm.get('address')?.invalid && userForm.get('address')?.touched" class="text-red-500 text-xs mt-1">
              Address is required.
            </div>
          </div>

          <!-- Unit -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1.5">Unit <span class="text-red-500">*</span></label>
            <select formControlName="unitId"
              class="w-full px-4 py-2.5 text-sm border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 bg-white">
              <option [ngValue]="null" selected>Select Unit</option>
              <option *ngFor="let unit of units" [ngValue]="unit.id">{{ unit.name }}</option>
            </select>
            <div *ngIf="userForm.get('unitId')?.invalid && userForm.get('unitId')?.touched" class="text-red-500 text-xs mt-1">
              Unit is required.
            </div>
          </div>

          <!-- Role -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1.5">Role <span class="text-red-500">*</span></label>
            <select formControlName="roleId"
              class="w-full px-4 py-2.5 text-sm border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 bg-white">
              <option [ngValue]="null" disabled selected>Select Role</option>
              <option *ngFor="let role of roles" [ngValue]="role.id">{{ role.roleName }}</option>
            </select>
            <div *ngIf="userForm.get('roleId')?.invalid && userForm.get('roleId')?.touched" class="text-red-500 text-xs mt-1">
              Role is required.
            </div>
          </div>
        </div>

        <!-- Action Buttons (Stack vertically on small screens, side-by-side on medium screens) -->
        <div class="flex flex-col sm:flex-row gap-4 pt-4">
          <button type="submit"
            class="w-full sm:w-auto px-6 py-3 bg-indigo-600 text-white rounded-xl text-sm font-semibold shadow-md hover:bg-indigo-700 transition-all duration-150 active:scale-[0.98] focus:ring focus:ring-indigo-300 focus:ring-offset-2"
            [disabled]="userForm.invalid">
            Create User
          </button>
          <button type="button" (click)="onCancel()"
            class="w-full sm:w-auto px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl text-sm font-medium hover:bg-gray-100 transition-all duration-150 active:scale-[0.98]">
            Cancel
          </button>
        </div>
      </div>
    </div>
  </form>
</div>